{'apiVersion': None, 'id': 'invoice_payment_matching', 'description': None, 'version': '1.0', 'vars': {'請求書データファイルパス': {'type': 'string', 'description': '請求書データのExcelファイルパス'}, '入金明細データファイルパス': {'type': 'string', 'description': '入金明細データのExcelファイルパス'}, 'Excel出力ファイルパス': {'type': 'string', 'description': '結果出力用Excelファイルパス'}}, 'policy': None, 'ui': {'layout': ['input_invoice_file', 'input_payment_file', 'read_invoice', 'read_payment', 'match_records', 'write_result']}, 'graph': [{'id': 'input_invoice_file', 'description': None, 'block': 'ui.interactive_input', 'type': None, 'inputs': {'context': {}, 'message': '請求書データのExcelファイルをアップロードしてください。', 'mode': 'file', 'requirements': {'file_type': ['xlsx', 'xls']}}, 'outputs': {'collected_data': 'invoice_file'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'input_payment_file', 'description': None, 'block': 'ui.interactive_input', 'type': None, 'inputs': {'context': {}, 'message': '入金明細データのExcelファイルをアップロードしてください。', 'mode': 'file', 'requirements': {'file_type': ['xlsx', 'xls']}}, 'outputs': {'collected_data': 'payment_file'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'read_invoice', 'description': None, 'block': 'excel.read_data', 'type': None, 'inputs': {'mode': 'default', 'read_config': {}, 'recalc': False, 'workbook': '${input_invoice_file.collected_data}'}, 'outputs': {'data': 'invoice_data', 'rows': 'invoice_rows', 'summary': 'invoice_summary'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'read_payment', 'description': None, 'block': 'excel.read_data', 'type': None, 'inputs': {'mode': 'default', 'read_config': {}, 'recalc': False, 'workbook': '${input_payment_file.collected_data}'}, 'outputs': {'data': 'payment_data', 'rows': 'payment_rows', 'summary': 'payment_summary'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'match_records', 'description': None, 'block': 'ai.process_llm', 'type': None, 'inputs': {'evidence_data': {'invoices': '${read_invoice.rows}', 'payments': '${read_payment.rows}'}, 'instruction': '請求書データと入金明細データを照合し、請求書ごとに対応する入金明細をマッチングしてください。マッチング結果には、請求書番号、請求金額、入金日、入金金額、マッチング状況（完全一致/部分一致/未入金）を含めてください。', 'output_schema': {'invoice_no': 'string', 'invoice_amount': 'number', 'payment_date': 'string', 'payment_amount': 'number', 'match_status': 'string'}}, 'outputs': {'results': 'matched_results'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'write_result', 'description': None, 'block': 'excel.write', 'type': None, 'inputs': {'cell_updates': [], 'column_updates': {'請求書番号': 'invoice_no', '請求金額': 'invoice_amount', '入金日': 'payment_date', '入金金額': 'payment_amount', 'マッチング状況': 'match_status'}, 'match_updates': [], 'workbook': '${input_invoice_file.collected_data}', 'values': '${match_records.results}'}, 'outputs': {'workbook_b64': 'output_workbook_b64', 'workbook_updated': 'output_workbook', 'write_summary': 'write_summary'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}]}
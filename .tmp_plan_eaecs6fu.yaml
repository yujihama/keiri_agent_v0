{'apiVersion': None, 'id': 'invoice_payment_matching', 'description': None, 'version': '1.0', 'vars': {'請求書データファイルパス': {'type': 'string', 'description': '請求書データのExcelファイルパス'}, '入金明細データファイルパス': {'type': 'string', 'description': '入金明細データのExcelファイルパス'}, 'Excel出力ファイルパス': {'type': 'string', 'description': '結果出力用Excelファイルパス'}}, 'policy': None, 'ui': {'layout': ['input_invoice_file', 'input_payment_file', 'read_invoice', 'read_payment', 'match_records', 'write_result']}, 'graph': [{'id': 'input_invoice_file', 'description': None, 'block': 'ui.interactive_input', 'type': None, 'inputs': {'context': {}, 'message': '請求書データのExcelファイルをアップロードしてください。', 'mode': 'file', 'requirements': {'file_type': ['xlsx', 'xls'], 'var_assign': '請求書データファイルパス'}}, 'outputs': {'collected_data': '請求書データファイルパス'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'input_payment_file', 'description': None, 'block': 'ui.interactive_input', 'type': None, 'inputs': {'context': {}, 'message': '入金明細データのExcelファイルをアップロードしてください。', 'mode': 'file', 'requirements': {'file_type': ['xlsx', 'xls'], 'var_assign': '入金明細データファイルパス'}}, 'outputs': {'collected_data': '入金明細データファイルパス'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'read_invoice', 'description': None, 'block': 'excel.read_data', 'type': None, 'inputs': {'mode': 'data_only', 'read_config': {'sheet': 0, 'header_row': 1}, 'recalc': False, 'workbook': '${vars.請求書データファイルパス}'}, 'outputs': {'data': 'invoice_data', 'rows': 'invoice_rows', 'summary': 'invoice_summary'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'read_payment', 'description': None, 'block': 'excel.read_data', 'type': None, 'inputs': {'mode': 'data_only', 'read_config': {'sheet': 0, 'header_row': 1}, 'recalc': False, 'workbook': '${vars.入金明細データファイルパス}'}, 'outputs': {'data': 'payment_data', 'rows': 'payment_rows', 'summary': 'payment_summary'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'match_records', 'description': None, 'block': 'ai.process_llm', 'type': None, 'inputs': {'evidence_data': {'invoices': '${read_invoice.data}', 'payments': '${read_payment.data}'}, 'instruction': '請求書データと入金明細データを照合し、請求書ごとに対応する入金明細をマッチングしてください。マッチング結果には、請求書番号、請求金額、入金金額、入金日、マッチングステータス（完全一致/部分一致/未入金）を含めてください。', 'output_schema': {'請求書番号': 'string', '請求金額': 'number', '入金金額': 'number', '入金日': 'string', 'マッチングステータス': 'string'}}, 'outputs': {'results': 'matched_results'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'write_result', 'description': None, 'block': 'excel.write', 'type': None, 'inputs': {'cell_updates': [], 'column_updates': {'請求書番号': '請求書番号', '請求金額': '請求金額', '入金金額': '入金金額', '入金日': '入金日', 'マッチングステータス': 'マッチングステータス'}, 'match_updates': [], 'workbook': '${vars.Excel出力ファイルパス}', 'values': '${match_records.results}'}, 'outputs': {'workbook_b64': 'result_workbook_b64', 'workbook_updated': 'result_workbook_updated', 'write_summary': 'result_write_summary'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}]}
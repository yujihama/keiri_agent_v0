{'apiVersion': None, 'id': 'invoice_payment_matching_plan', 'description': None, 'version': '1.0', 'vars': {'請求書データファイルパス': '', '入金明細データファイルパス': '', 'Excel出力ファイルパス': ''}, 'policy': None, 'ui': {'layout': ['read_invoice', 'read_payment', 'match_records', 'write_result']}, 'graph': [{'id': 'read_invoice', 'description': None, 'block': 'excel.read_data', 'type': None, 'inputs': {'workbook': {'name': '請求書データ.xlsx', 'bytes': '${vars.請求書データファイルパス}'}, 'mode': 'single', 'read_config': {'sheets': [{'name': '請求書', 'header_row': 1, 'skip_empty_rows': True}], 'date_as_iso': True}}, 'outputs': {'rows': 'invoice_rows'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'read_payment', 'description': None, 'block': 'excel.read_data', 'type': None, 'inputs': {'workbook': {'name': '入金明細データ.xlsx', 'bytes': '${vars.入金明細データファイルパス}'}, 'mode': 'single', 'read_config': {'sheets': [{'name': '入金明細', 'header_row': 1, 'skip_empty_rows': True}], 'date_as_iso': True}}, 'outputs': {'rows': 'payment_rows'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'match_records', 'description': None, 'block': 'ai.process_llm', 'type': None, 'inputs': {'evidence_data': {'請求書': '${read_invoice.invoice_rows}', '入金明細': '${read_payment.payment_rows}'}, 'instruction': '請求書データと入金明細データを照合し、請求書番号・金額・日付などをもとに対応する入金を特定してください。照合結果として、請求書ごとに対応する入金明細（なければ空）を出力してください。', 'output_schema': {'matches': {'type': 'array', 'items': {'type': 'object', 'properties': {'請求書番号': {'type': 'string'}, '請求日': {'type': 'string'}, '請求金額': {'type': 'number'}, '入金日': {'type': ['string', 'null']}, '入金金額': {'type': ['number', 'null']}, '入金明細番号': {'type': ['string', 'null']}, '照合結果': {'type': 'string'}}, 'required': ['請求書番号', '請求日', '請求金額', '照合結果']}}}}, 'outputs': {'results': 'match_results'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}, {'id': 'write_result', 'description': None, 'block': 'excel.write', 'type': None, 'inputs': {'workbook': {'name': '照合結果出力.xlsx', 'bytes': '${vars.Excel出力ファイルパス}'}, 'column_updates': [{'sheet': '照合結果', 'header_row': 1, 'columns': [{'header': '請求書番号', 'path': '請求書番号'}, {'header': '請求日', 'path': '請求日'}, {'header': '請求金額', 'path': '請求金額'}, {'header': '入金日', 'path': '入金日'}, {'header': '入金金額', 'path': '入金金額'}, {'header': '入金明細番号', 'path': '入金明細番号'}, {'header': '照合結果', 'path': '照合結果'}], 'values': '${match_records.match_results.matches}', 'write_header': True, 'clear_existing': True}]}, 'outputs': {'workbook_b64': 'output_excel_b64', 'workbook_updated': 'output_excel_obj', 'write_summary': 'output_write_summary'}, 'when': None, 'foreach': None, 'while_': None, 'body': None, 'call': None, 'policy': None}]}
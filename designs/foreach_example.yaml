apiVersion: v1
id: foreach_example
version: 0.1.0
vars:
  instruction: "各要素に対して照合"
ui:
  layout: []
graph:
  - id: seed
    block: ai.invoice_payment_match
    in:
      evidence_data: ${vars.instruction}
      instruction: ${vars.instruction}
    out:
      results: r
      summary: s
  - id: foreach_data
    type: loop
    foreach:
      input: ${seed.s}
      itemVar: data_item
      max_concurrency: 2
    body:
      plan:
        id: per_item
        version: 0.0.1
        graph:
          - id: per_item_match
            block: ai.invoice_payment_match
            in:
              evidence_data: ${vars.data_item}
              instruction: ${vars.instruction}
            out:
              results: item_result
              summary: item_summary
    out:
      collect: item_result_list


